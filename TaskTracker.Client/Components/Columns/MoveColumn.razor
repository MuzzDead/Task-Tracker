@using AntDesign
@using TaskTracker.Client.DTOs.Column

<div class="column-move-modal-backdrop @(_visible ? "visible" : "")"
     @onclick=@HandleBackdropClick>
    <div class="column-move-modal-container" @onclick:stopPropagation="true">
        <Card Class="column-move-card" Bordered="true">
            <div class="column-card-header">
                <h3>Move Column</h3>
                <Button Type=@ButtonType.Text
                        Icon="close"
                        Size=@ButtonSize.Small
                        OnClick=@HandleCancel
                        Class="close-button" />
            </div>

            <div class="column-card-body">
                <Flex Direction=@FlexDirection.Vertical Gap=@FlexGap.Middle>
                    <Form Model=@_formModel>
                        <FormItem Label="Column Name">
                            <Input @bind-Value=@_formModel.ColumnName
                                   Disabled="true"
                                   Style="width: 100%;" />
                        </FormItem>
                        <FormItem Label="Position">
                            <Select Value=@_formModel.BeforeColumnId
                                    OnSelectedItemChanged=@OnPositionChanged
                                    Loading=@IsPositionUpdating
                                    Style="width: 100%;"
                                    TItem="Guid"
                                    TItemValue="Guid">
                                @if (BoardColumns != null)
                                {
                                    @foreach (var column in BoardColumns)
                                    {
                                        <SelectOption Value=@column.Id
                                                      Label=@($"Before \"{column.Title}\"") />
                                    }
                                }
                            </Select>
                        </FormItem>
                    </Form>
                </Flex>
            </div>

            <div class="column-card-footer">
                <div class="column-card-actions">
                    <Button OnClick=@HandleCancel>Cancel</Button>
                    <Button Type=@ButtonType.Primary
                            Disabled=@(!IsPositionSelected || IsSaving || Column is null)
                            Loading=@IsSaving
                            OnClick=@HandleSave>
                        Move
                    </Button>
                </div>
            </div>
        </Card>
    </div>
</div>